<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>THIS en JavaScript</title>
</head>

<body>
  <h1>THIS en JavaScript</h1>

  <script>
    /*
      THIS
        - Hace referencia al objeto global, en el contexto de ejecución global (fuera de cualquier función), this se refiere al objeto global, ya sea en modo estricto o no, hace referencia al contexto en el que estemos ejecutando las cosas

        - this es una referencia que se crea cuando una función es invocada, no declarada. El valor de esa referencia depende al 100% del lugar en la que esa invocación se realice, llamado call-site.

        - Ese lugar de llamada es la invocación en sí a la función. Es decir, el momento justo en que es llamada (no declarada, no referenciada) esa función.

        - Como estamos tratando con JavaScript, vamos a examinar los call-site a funciones en los escenarios más comunes.

      CLOUSURE: 
        - Envolver una función dentro de otra función


      NOTAS:
        - Una arrow function lo que hace es mantener un enlace del contexto en el que ha sido creado el objeto donde aparece
    */

    console.log(this);
    console.log(window);
    console.log(this === window);

    this.nombre = "Contexto Global";
    console.log(this.nombre);

    function imprimir() {
      console.log(this.nombre);
    }

    imprimir();

    const obj = {
      nombre: "Contexto Objeto",
      imprimir: function () {
        console.log(this.nombre);
      }
    }

    obj.imprimir();

    const obj2 = {
      nombre: "Contexto Objeto 2",
      imprimir
    }

    obj2.imprimir();

    const obj3 = {
      nombre: "Contexto Objeto 3",
      imprimir: () => {
        console.log(this.nombre);
      }
    }

    obj3.imprimir();

    function Persona(nombre) {
      const that = this;
      that.nombre = nombre;

      //return console.log(this.nombre);

      // return function () {
      //   console.log(this.nombre);
      // }

      // return () => console.log(this.nombre);

      return function () {
        console.log(that.nombre);
      }

    }

    let jon = new Persona("Jon");
    jon();

  </script>
</body>

</html>